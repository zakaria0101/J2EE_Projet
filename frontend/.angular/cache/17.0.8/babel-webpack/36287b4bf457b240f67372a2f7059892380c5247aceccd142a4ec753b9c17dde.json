{"ast":null,"code":"import { ProductService } from '../../services/product.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { CartService } from '../../services/cart.service';\nimport { CookieService } from 'ngx-cookie-service';\nimport { ProductInOrder } from '../../models/ProductInOrder';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/product.service\";\nimport * as i2 from \"../../services/cart.service\";\nimport * as i3 from \"ngx-cookie-service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nfunction DetailComponent_button_37_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"button\", 18);\n    i0.ɵɵtext(1, \"Add to Cart \");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    i0.ɵɵnextContext();\n    const _r0 = i0.ɵɵreference(10);\n    i0.ɵɵproperty(\"disabled\", !_r0.form.valid);\n  }\n}\nfunction DetailComponent_ng_template_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 19);\n    i0.ɵɵtext(1, \"Unavailable\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let DetailComponent = /*#__PURE__*/(() => {\n  class DetailComponent {\n    constructor(productService, cartService, cookieService, route, router) {\n      this.productService = productService;\n      this.cartService = cartService;\n      this.cookieService = cookieService;\n      this.route = route;\n      this.router = router;\n    }\n    ngOnInit() {\n      this.getProduct();\n      this.title = 'Product Detail';\n      this.count = 1;\n    }\n    // ngOnChanges(changes: SimpleChanges): void {\n    //   // Called before any other lifecycle hook. Use it to inject dependencies, but avoid any serious work here.\n    //   // Add '${implements OnChanges}' to the class.\n    //   console.log(changes);\n    //   if (this.item.quantity in changes) {\n    //   }\n    // }\n    getProduct() {\n      const id = this.route.snapshot.paramMap.get('id');\n      this.productService.getDetail(id).subscribe(prod => {\n        this.productInfo = prod;\n      }, _ => console.log('Get Cart Failed'));\n    }\n    addToCart() {\n      this.cartService.addItem(new ProductInOrder(this.productInfo, this.count)).subscribe(res => {\n        if (!res) {\n          console.log('Add Cart failed' + res);\n          throw new Error();\n        }\n        this.router.navigateByUrl('/cart');\n      }, _ => console.log('Add Cart Failed'));\n    }\n    validateCount() {\n      console.log('Validate');\n      const max = this.productInfo.productStock;\n      if (this.count > max) {\n        this.count = max;\n      } else if (this.count < 1) {\n        this.count = 1;\n      }\n    }\n    static #_ = this.ɵfac = function DetailComponent_Factory(t) {\n      return new (t || DetailComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.CartService), i0.ɵɵdirectiveInject(i3.CookieService), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i4.Router));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DetailComponent,\n      selectors: [[\"app-detail\"]],\n      decls: 40,\n      vars: 16,\n      consts: [[\"align\", \"center\", 1, \"display-4\", \"mb-5\"], [1, \"row\", \"text-center\", \"justify-content-center\"], [1, \"col-lg-6\"], [1, \"card\", \"mb-4\"], [\"height\", \"60%\", 1, \"card-img-top\", 3, \"src\"], [1, \"card-body\"], [1, \"card-title\"], [\"name\", \"form\", 3, \"ngSubmit\"], [\"form\", \"ngForm\"], [1, \"text-left\"], [\"hidden\", \"\", \"name\", \"productId\", 3, \"value\"], [1, \"card-test\"], [1, \"card-text\"], [\"id\", \"price\"], [\"type\", \"number\", \"name\", \"count\", \"required\", \"\", \"min\", \"1\", 3, \"ngModel\", \"max\", \"ngModelChange\", \"change\"], [\"id\", \"subtotal\"], [\"type\", \"submit\", \"class\", \"btn btn-primary btn-lg\", 3, \"disabled\", 4, \"ngIf\", \"ngIfElse\"], [\"offBlock\", \"\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"btn-lg\", 3, \"disabled\"], [1, \"btn\", \"btn-secondary\", \"btn-lg\", \"disabled\"]],\n      template: function DetailComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"h1\", 0);\n          i0.ɵɵtext(1);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"div\", 1)(3, \"div\", 2)(4, \"div\", 3);\n          i0.ɵɵelement(5, \"img\", 4);\n          i0.ɵɵelementStart(6, \"div\", 5)(7, \"h4\", 6);\n          i0.ɵɵtext(8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"form\", 7, 8);\n          i0.ɵɵlistener(\"ngSubmit\", function DetailComponent_Template_form_ngSubmit_9_listener() {\n            return (ctx.productInfo == null ? null : ctx.productInfo.productStatus) == 0 && ctx.addToCart();\n          });\n          i0.ɵɵelementStart(11, \"div\", 9);\n          i0.ɵɵelement(12, \"input\", 10);\n          i0.ɵɵelementStart(13, \"p\", 11)(14, \"strong\");\n          i0.ɵɵtext(15, \"Description: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(16);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"p\", 12)(18, \"strong\");\n          i0.ɵɵtext(19, \"Price: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(20, \"label\", 13);\n          i0.ɵɵtext(21);\n          i0.ɵɵpipe(22, \"currency\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(23, \"p\", 12)(24, \"strong\");\n          i0.ɵɵtext(25, \"Stock: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtext(26);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(27, \"label\", 12)(28, \"strong\");\n          i0.ɵɵtext(29, \"Quantity: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(30, \"input\", 14);\n          i0.ɵɵlistener(\"ngModelChange\", function DetailComponent_Template_input_ngModelChange_30_listener($event) {\n            return ctx.count = $event;\n          })(\"change\", function DetailComponent_Template_input_change_30_listener() {\n            return ctx.validateCount();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(31, \"p\", 12)(32, \"strong\");\n          i0.ɵɵtext(33, \"Subtotal: \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(34, \"label\", 15);\n          i0.ɵɵtext(35);\n          i0.ɵɵpipe(36, \"currency\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(37, DetailComponent_button_37_Template, 2, 1, \"button\", 16)(38, DetailComponent_ng_template_38_Template, 2, 0, \"ng-template\", null, 17, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          const _r3 = i0.ɵɵreference(39);\n          i0.ɵɵadvance(1);\n          i0.ɵɵtextInterpolate(ctx.title);\n          i0.ɵɵadvance(4);\n          i0.ɵɵpropertyInterpolate(\"src\", ctx.productInfo == null ? null : ctx.productInfo.productIcon, i0.ɵɵsanitizeUrl);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(ctx.productInfo == null ? null : ctx.productInfo.productName);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"value\", ctx.productInfo == null ? null : ctx.productInfo.productId);\n          i0.ɵɵadvance(4);\n          i0.ɵɵtextInterpolate(ctx.productInfo == null ? null : ctx.productInfo.productDescription);\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(22, 12, ctx.productInfo == null ? null : ctx.productInfo.productPrice));\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate(ctx.productInfo == null ? null : ctx.productInfo.productStock);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngModel\", ctx.count)(\"max\", ctx.productInfo == null ? null : ctx.productInfo.productStock);\n          i0.ɵɵadvance(5);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(36, 14, ctx.count * (ctx.productInfo == null ? null : ctx.productInfo.productPrice)));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", (ctx.productInfo == null ? null : ctx.productInfo.productStatus) == 0)(\"ngIfElse\", _r3);\n        }\n      },\n      dependencies: [i5.NgIf, i6.ɵNgNoValidate, i6.DefaultValueAccessor, i6.NumberValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.RequiredValidator, i6.MinValidator, i6.MaxValidator, i6.NgModel, i6.NgForm, i5.CurrencyPipe]\n    });\n  }\n  return DetailComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}