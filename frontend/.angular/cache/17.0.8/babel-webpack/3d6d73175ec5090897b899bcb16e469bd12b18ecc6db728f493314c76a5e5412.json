{"ast":null,"code":"import { HttpClient } from \"@angular/common/http\";\nimport { OrderService } from \"../../services/order.service\";\nimport { OrderStatus } from \"../../enum/OrderStatus\";\nimport { UserService } from \"../../services/user.service\";\nimport { ActivatedRoute } from \"@angular/router\";\nimport { Role } from \"../../enum/Role\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../../services/order.service\";\nimport * as i3 from \"../../services/user.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../parts/pagination/pagination.component\";\nfunction OrderComponent_tr_24_a_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 9);\n    i0.ɵɵtext(1, \" Show\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const order_r1 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"/order/\", order_r1.orderId, \"\");\n  }\n}\nfunction OrderComponent_tr_24_a_21_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 10);\n    i0.ɵɵlistener(\"click\", function OrderComponent_tr_24_a_21_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const order_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.cancel(order_r1));\n    });\n    i0.ɵɵtext(1, \"Cancel\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction OrderComponent_tr_24_a_22_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"a\", 10);\n    i0.ɵɵlistener(\"click\", function OrderComponent_tr_24_a_22_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const order_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.finish(order_r1));\n    });\n    i0.ɵɵtext(1, \" Finish\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction OrderComponent_tr_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 5);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\", 6);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\", 6);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\", 6);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 6);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\", 6);\n    i0.ɵɵtext(12);\n    i0.ɵɵpipe(13, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\", 6);\n    i0.ɵɵtext(15);\n    i0.ɵɵpipe(16, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"td\", 6);\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"td\", 6);\n    i0.ɵɵtemplate(20, OrderComponent_tr_24_a_20_Template, 2, 1, \"a\", 7)(21, OrderComponent_tr_24_a_21_Template, 2, 0, \"a\", 8)(22, OrderComponent_tr_24_a_22_Template, 2, 0, \"a\", 8);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const order_r1 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", order_r1.orderId, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(order_r1.buyerName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(order_r1.buyerEmail);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(order_r1.buyerPhone);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(order_r1.buyerAddress);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(13, 11, order_r1.orderAmount));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(16, 13, order_r1.createTime));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r0.OrderStatus[order_r1.orderStatus]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !(ctx_r0.currentUser.role == ctx_r0.Role.Customer && ctx_r0.currentUser.name == order_r1.buyerEmail));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", order_r1.orderStatus == 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.currentUser.role != ctx_r0.Role.Customer && order_r1.orderStatus == 0);\n  }\n}\nexport let OrderComponent = /*#__PURE__*/(() => {\n  class OrderComponent {\n    constructor(httpClient, orderService, userService, route) {\n      this.httpClient = httpClient;\n      this.orderService = orderService;\n      this.userService = userService;\n      this.route = route;\n      this.OrderStatus = OrderStatus;\n      this.Role = Role;\n    }\n    ngOnInit() {\n      this.currentUser = this.userService.currentUserValue;\n      this.querySub = this.route.queryParams.subscribe(() => {\n        this.update();\n      });\n    }\n    update() {\n      let nextPage = 1;\n      let size = 10;\n      if (this.route.snapshot.queryParamMap.get('page')) {\n        nextPage = +this.route.snapshot.queryParamMap.get('page');\n        size = +this.route.snapshot.queryParamMap.get('size');\n      }\n      this.orderService.getPage(nextPage, size).subscribe(page => this.page = page, _ => {\n        console.log(\"Get Orde Failed\");\n      });\n    }\n    cancel(order) {\n      this.orderService.cancel(order.orderId).subscribe(res => {\n        if (res) {\n          order.orderStatus = res.orderStatus;\n        }\n      });\n    }\n    finish(order) {\n      this.orderService.finish(order.orderId).subscribe(res => {\n        if (res) {\n          order.orderStatus = res.orderStatus;\n        }\n      });\n    }\n    ngOnDestroy() {\n      this.querySub.unsubscribe();\n    }\n    static #_ = this.ɵfac = function OrderComponent_Factory(t) {\n      return new (t || OrderComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.OrderService), i0.ɵɵdirectiveInject(i3.UserService), i0.ɵɵdirectiveInject(i4.ActivatedRoute));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: OrderComponent,\n      selectors: [[\"app-order\"]],\n      decls: 26,\n      vars: 2,\n      consts: [[\"align\", \"center\", 1, \"display-4\", \"mb-5\"], [1, \"table\", \"table-striped\", \"text-center\"], [\"scope\", \"col\"], [4, \"ngFor\", \"ngForOf\"], [3, \"currentPage\"], [\"scope\", \"row\", 1, \"align-middle\"], [1, \"align-middle\"], [\"style\", \"display:\\n            block\", \"href\", \"\", 3, \"routerLink\", 4, \"ngIf\"], [\"style\", \"display: block\", \"routerLink\", \"./\", 3, \"click\", 4, \"ngIf\"], [\"href\", \"\", 2, \"display\", \"block\", 3, \"routerLink\"], [\"routerLink\", \"./\", 2, \"display\", \"block\", 3, \"click\"]],\n      template: function OrderComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"h1\", 0);\n          i0.ɵɵtext(1, \"Orders\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"table\", 1)(3, \"thead\")(4, \"tr\")(5, \"th\", 2);\n          i0.ɵɵtext(6, \"Order #\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"th\", 2);\n          i0.ɵɵtext(8, \"Customer Name\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"th\", 2);\n          i0.ɵɵtext(10, \"Customer Email\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"th\", 2);\n          i0.ɵɵtext(12, \"Customer phone\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"th\", 2);\n          i0.ɵɵtext(14, \"Shipping Address\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"th\", 2);\n          i0.ɵɵtext(16, \"Total\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"th\", 2);\n          i0.ɵɵtext(18, \"Order Data\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"th\", 2);\n          i0.ɵɵtext(20, \"Status\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"th\", 2);\n          i0.ɵɵtext(22, \"Action\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(23, \"tbody\");\n          i0.ɵɵtemplate(24, OrderComponent_tr_24_Template, 23, 15, \"tr\", 3);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(25, \"app-pagination\", 4);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(24);\n          i0.ɵɵproperty(\"ngForOf\", ctx.page == null ? null : ctx.page.content);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"currentPage\", ctx.page);\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf, i4.RouterLink, i6.PaginationComponent, i5.CurrencyPipe, i5.DatePipe]\n    });\n  }\n  return OrderComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}